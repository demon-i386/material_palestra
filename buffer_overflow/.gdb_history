n
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
i
ni
c
r < shellcode
c
unset env
r < shellcode
disassemble main
b *0x0000000000400552
r
ni
ni
ni
r
r
ni
c
r < shellcode
unset env
r < shellcode
ni
ni
ni
c
c
c
ls
c
ls
x/20x $rsp
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
c
p system
c
c
c
c
c
c
c
c
b main
r
find &system,+9999999,"/bin/sh" 
find &system,+9999999,"/bin/sh" 
find &system,+9999999,"/bin/sh\0" 
find +9999999,"/bin/sh\0" 
c
c
c
exit
quit
c
c
c
c
c
c
c
c
c
c
r < shellcode
c
b system
c
r
c
c
c
c
c
c
c
c
c
c
c
c
c
c
b main
r
disassemble main
r < shellcde
r < shellcode
b main
r
disassemble 
b *0x0000000000400552
c
r < shellcode
c
c
r
c
ni
ni
ni
r
c
r < shellcode
c
c
r
c
ni
x/20i $rsp
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
c
r  < shellcode
c
r  < shellcode
c
c
r  < shellcode
c
x/20x $rsp
x/20i $rsp
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
r  < shellcode
c
c
r 
c
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
p $eax
ni
ni
ni
ni
ni
ni
ni
r < shellcode
c
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
ni
r
c
c
